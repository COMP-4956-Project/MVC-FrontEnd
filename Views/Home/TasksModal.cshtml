<div class="modal-overlay" onclick="closeModal()"></div>

<div id="tasksModal" class="modal" onclick="event.stopPropagation()">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="consistent-header">
                <h5 class="consistent-header">Tasks</h5>
            </div>
            <div class="modal-body-container">
                <!-- Left Column - modal-body -->
                <div class="modal-body">
                    <div class="task-label">Easy</div>
                    <div class="easy-tasks task-group"></div>
                    <div class="task-line"></div>
                    <div class="task-label">Medium</div>
                    <div class="medium-tasks task-group"></div>
                    <div class="task-line"></div>
                    <div class="task-label">Hard</div>
                    <div class="difficult-tasks task-group"></div>
                </div>
                <!-- Right Column - Confirm Button -->
                <div class="confirm-button-container"></div>
            </div>
        </div>
    </div>
</div>


<script>
    let selectedTask = null;
    const easyTasksContainer = document.querySelector('.easy-tasks');
    const mediumTasksContainer = document.querySelector('.medium-tasks');
    const difficultTasksContainer = document.querySelector('.difficult-tasks');
    const confirmButtonContainer = document.querySelector('.confirm-button-container');
    let taskNumber = 1;

    function updateDescriptionInParent(selectedTask)
    {
        // Update the description in the parent component (Index.cshtml)
        $('.description-of-selected-task').text(selectedTask);
    }

    function openTasksModal()
    {
        document.querySelector('.modal-overlay').style.display = 'block';
        document.getElementById('tasksModal').style.display = 'block';
    }

    function closeModal()
    {
        document.querySelector('.modal-overlay').style.display = 'none';
        document.getElementById('tasksModal').style.display = 'none';
    }

    for (let row = 1; row <= 10; row++)
    {
        for (let col = 1; col <= 10; col++)
        {
            const taskSquare = document.createElement('div');
            taskSquare.classList.add('task-square');
            taskSquare.dataset.task = taskNumber;
            taskSquare.textContent = taskNumber;

            taskSquare.addEventListener('click', () =>
            {
                const allTaskSquares = document.querySelectorAll('.task-square');
                allTaskSquares.forEach(otherSquare =>
                {
                    otherSquare.classList.remove('task-active');
                });

                taskSquare.classList.add('task-active');
                selectedTask = taskSquare.textContent; //  ================================ set selectedTask to the value of the active task

                // Remove existing confirm button
                confirmButtonContainer.innerHTML = '';

                // Create and append confirm button
                const confirmButton = document.createElement('button');
                confirmButton.classList.add('confirm-task-button');
                confirmButton.textContent = 'Confirm';
                confirmButtonContainer.appendChild(confirmButton);

                // Add event listener to the confirm button
                confirmButton.addEventListener('click', () =>
                {
                    console.log('Task number TO BE emitted: ', selectedTask);
                    updateDescriptionInParent(selectedTask);
                    closeModal();
                });
            });

            if (taskNumber <= 20)
            {
                easyTasksContainer.appendChild(taskSquare);
            } else if (taskNumber <= 80)
            {
                mediumTasksContainer.appendChild(taskSquare);
            } else
            {
                difficultTasksContainer.appendChild(taskSquare);
            }

            taskNumber++;
        }
    }
</script>



<style>
    .task-square:hover {
        background-color: rgb(206, 204, 204);
    }

    .task-active {
        background-color: rgb(137, 136, 136) !important;
    }

    .task-square {
        width: 30px;
        height: 30px;
        background-color: rgb(234, 231, 231);
        text-align: center;
        line-height: 30px;
        cursor: pointer;
        transition: background-color 0.2s;
        border: 1px solid #000;
    }

    .task-label {
        text-align: center;
        font-weight: bold;
    }

    .task-line {
        background-color: white;
        height: 2px;
        margin: 5px 0;
    }

    .confirm-task-button {
        background-color: #4caf50;
        border: none;
        color: white;
        padding: 10px 20px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        margin-top: 37px;
        cursor: pointer;
        border-radius: 5px;
        transition: background-color 0.3s;
    }

    .confirm-task-button:hover {
        background-color: #45a049;
    }
</style>